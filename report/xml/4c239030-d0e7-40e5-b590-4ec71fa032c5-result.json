{"name": "test_api[case_data5]", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'float'", "trace": "self = <case.test_allocation.TestCase object at 0x10657fa58>\ncase_data = {'APIName': '审批调拨订单', 'CaseId': 6.0, 'CaseName': 'approve_allocation_bill', 'CheckTpye': 'check_json', ...}\n\n    @pytest.mark.parametrize('case_data', case_dict, ids=[])\n    @allure.story(\"调拨模块测试\")\n    @pytest.mark.flaky(reruns=3, reruns_delay=3)\n    def test_api(self, case_data):\n        '''\n        :param case_data: 测试用例\n        :return:\n        '''\n        code, response = h.send_requests(case_data)\n>       result = checkResult.check_result(case_data, code, response)\n\ntest_allocation.py:51: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../util/checkResult.py:81: in check_result\n    allure.attach(case['ExpectedCode'],'预期code')\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py:164: in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n../venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py:215: in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py:117: in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <allure_commons.logger.AllureFileLogger object at 0x105a30630>\nbody = 200.0\nfile_name = '51a10c30-d679-41b9-bf2d-a11dfb0c05e3-attachment.attach'\n\n    @hookimpl\n    def report_attached_data(self, body, file_name):\n        destination = os.path.join(self._report_dir, file_name)\n        with open(destination, 'wb') as attached_file:\n            if isinstance(body, text_type):\n                attached_file.write(body.encode('utf-8'))\n            else:\n>               attached_file.write(body)\nE               TypeError: a bytes-like object is required, not 'float'\n\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py:62: TypeError"}, "description": "\n        :param case_data: 测试用例\n        :return:\n        ", "steps": [{"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "559d9870-2e3a-4fd1-9e68-48fab7424ae6-attachment.attach"}, {"name": "用例名称:", "source": "85270a4b-8c3a-4f9c-80f7-4d2551a40020-attachment.attach"}, {"name": "请求地址:", "source": "f01f1a4a-933f-41e7-a8c7-4c01e4ab1b6e-attachment.attach"}, {"name": "请求头", "source": "ddea236b-d483-448a-be61-35aa1fd1d355-attachment.attach"}, {"name": "请求参数类型", "source": "aa58394a-b351-4bb4-a4f6-e904ac0bd9fa-attachment.attach"}, {"name": "请求参数", "source": "c1b3c5bf-1abe-41cf-b0a6-20eec099dbad-attachment.attach"}], "start": 1589351919512, "stop": 1589351919514}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "2eb61651-e754-4e27-908b-b6213fa62d87-attachment.attach"}, {"name": "用例名称:", "source": "d49e2d06-9a7c-4edc-94ba-23a931bb371c-attachment.attach"}, {"name": "请求地址:", "source": "dd7ea642-eee4-467b-a678-50acb59cc17f-attachment.attach"}, {"name": "请求头", "source": "549fd6d1-4ca7-48be-9d6e-90fa62e67e5f-attachment.attach"}, {"name": "请求参数类型", "source": "8f32ee45-fdd3-4b65-8d1d-ad506da4ea7a-attachment.attach"}, {"name": "请求参数", "source": "c952b422-a87c-40a9-b75e-ffbc91d9b648-attachment.attach"}], "start": 1589351922553, "stop": 1589351922554}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "452ed022-2294-454e-8646-c67577dc20ec-attachment.attach"}, {"name": "用例名称:", "source": "5fd9b2e6-75cb-4134-b897-ce6c1f909cb8-attachment.attach"}, {"name": "请求地址:", "source": "e1934ca7-8e07-4505-8187-cdf6e07cb06f-attachment.attach"}, {"name": "请求头", "source": "02e3502d-942f-4c2f-9207-65e733469b49-attachment.attach"}, {"name": "请求参数类型", "source": "0267d67b-63f7-42f4-85dc-e38eb075c52c-attachment.attach"}, {"name": "请求参数", "source": "04d594f2-dd05-42bb-beb2-90f3159dda3c-attachment.attach"}], "start": 1589351923012, "stop": 1589351923014}, {"name": "校验返回json数据结构", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'float'\n", "trace": "  File \"/Users/xmly/python/AutoTest/util/checkResult.py\", line 81, in check_result\n    allure.attach(case['ExpectedCode'],'预期code')\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py\", line 164, in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py\", line 215, in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py\", line 117, in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py\", line 62, in report_attached_data\n    attached_file.write(body)\n"}, "attachments": [{"name": "预期code", "source": "51a10c30-d679-41b9-bf2d-a11dfb0c05e3-attachment.attach"}], "start": 1589351924290, "stop": 1589351924291}], "attachments": [{"name": "log", "source": "96a9cf09-9691-48ea-b905-c57ea16c7c32-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case_data", "value": "{'CaseId': 6.0, 'CaseName': 'approve_allocation_bill', 'APIName': '审批调拨订单', 'Headers': \"{'Content-Type':'application/json','charset': 'UTF-8'}\", 'Path': '/occ-stock/stock/allocation-bill/approveWithoutBpm', 'Method': 'post', 'ParameterType': 'parameter', 'Params': '{\"billId\":\"allocation-create-and-submit2\"}', 'CheckTpye': 'check_json', 'ExpectedCode': 200.0, 'ExpectedData': '{\"success\":\"success\",\"message\":\"&#23457;&#25209;&#36890;&#36807;&#25104;&#21151;\",\"detailMsg\":{\"data\":[{\"id\":\"0kxUvN0mm3QI7AhjYqSM\",\"dr\":0,\"ts\":1589274004553,\"creator\":\"smq\",\"creationTime\":1589273772000,\"modifier\":\"smq\",\"modifiedTime\":1589274004553,\"persistStatus\":\"upd\",\"promptMessage\":null,\"state\":3,\"approver\":\"smq\",\"approveTime\":1589274004553,\"approveOpinion\":null,\"sycnNCStatus\":null,\"sycnOutStatus\":null,\"pkOrgId\":\"abd7cf79-511d-4307-9bbd-d288b18d0ef9\",\"pkOrgCode\":\"1210\",\"pkOrgName\":\"西安喜马拉雅网络科技有限公司\",\"pkOrgInId\":\"abd7cf79-511d-4307-9bbd-d288b18d0ef9\",\"pkOrgInCode\":\"1210\",\"pkOrgInName\":\"西安喜马拉雅网络科技有限公司\",\"code\":\"DBO20200512000019\",\"billDate\":1589212800000,\"billType\":\"Allocation\",\"billTranTypeId\":\"Allocation\",\"billTranTypeCode\":\"Allocation\",\"billTranTypeName\":\"调拨单\",\"outStorageId\":\"1001ZZ100000000DPAP4\",\"outStorageCode\":\"test030201\",\"outStorageName\":\"测试仓库030201\",\"outIfSlotManage\":null,\"inStorageId\":\"1001ZZ100000000DPAP6\",\"inStorageCode\":\"test030202\",\"inStorageName\":\"test030202\",\"inIfSlotManage\":null,\"outBizPersonId\":null,\"outBizPersonCode\":null,\"outBizPersonName\":null,\"inBizPersonId\":\"0mWG6nOSCxjsi1zoKEYs\",\"inBizPersonCode\":\"007\",\"inBizPersonName\":\"师孟奇\",\"outDeptId\":\"0K1ovYvAl1Pk00oCRPjV\",\"outDeptCode\":\"01010102\",\"outDeptName\":\"城市经理\",\"inDeptId\":null,\"inDeptCode\":null,\"inDeptName\":null,\"planSendDate\":null,\"planArriveDate\":null,\"currencyId\":\"CURRENCY-01\",\"currencyCode\":\"RMB\",\"currencyName\":\"人民币\",\"totalFactOutNum\":null,\"totalFactInNum\":null,\"billStatusId\":null,\"billStatusCode\":null,\"billStatusName\":null,\"transferStatusId\":\"0s21f51c-4d42-4100-dkd0-3254fbq33e6k\",\"transferStatusCode\":\"2\",\"transferStatusName\":\"已提交审批\",\"stockBillBelong\":null,\"customerId\":null,\"customerName\":null,\"customerCode\":null,\"isClose\":0,\"closer\":null,\"closeDate\":null,\"closeReason\":null,\"remark\":\"自动化测试编辑调拨单\",\"transferBillItems\":[{\"id\":\"0Wfar8LVlCZOkFv2gos9\",\"dr\":0,\"ts\":1589273890000,\"creator\":\"smq\",\"creationTime\":1589273775000,\"modifier\":\"smq\",\"modifiedTime\":1589273890000,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"rowNum\":10,\"transferBillId\":\"0kxUvN0mm3QI7AhjYqSM\",\"goodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"goodsCode\":\"301020000049\",\"goodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"goodsFullName\":null,\"goodsBasicUnitName\":\"个\",\"goodsAssistUnitName\":\"个\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productLineId\":null,\"isOptional\":null,\"unitId\":\"UNIT-12\",\"unitCode\":\"EA\",\"unitName\":\"个\",\"transferNum\":25.00000000,\"onwayNum\":null,\"totalOutNum\":null,\"totalInNum\":null,\"unitPrice\":null,\"amountMoney\":0E-8,\"remark\":null,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"receiverAddress\":null,\"provinceId\":null,\"provinceCode\":null,\"provinceName\":null,\"cityId\":null,\"cityCode\":null,\"cityName\":null,\"countyId\":null,\"countyCode\":null,\"countyName\":null,\"townId\":null,\"townCode\":null,\"townName\":null,\"detailAddr\":null,\"receiver\":null,\"receiverPhone\":null,\"receiverPhoneSpare\":null,\"isClose\":0,\"sourceId\":null,\"sourceLineNum\":null,\"sourceType\":null,\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"isMotherPiece\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"enableBatchNoManage\":null,\"enableInvStatusManage\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"outStorageId\":\"1001ZZ100000000DPAP4\",\"outStorageCode\":\"test030201\",\"outStorageName\":\"测试仓库030201\",\"outIfSlotManage\":null,\"inStorageId\":\"1001ZZ100000000DPAP6\",\"inStorageCode\":\"test030202\",\"inStorageName\":\"test030202\",\"inIfSlotManage\":null,\"outPositionId\":null,\"outPositionCode\":null,\"outPositionName\":null}],\"transferBillItemBoms\":[{\"id\":\"0rYlYTDrAqKnyukQYYWh\",\"dr\":0,\"ts\":1589273890000,\"creator\":\"smq\",\"creationTime\":1589273775000,\"modifier\":\"smq\",\"modifiedTime\":1589273890000,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"rowNum\":\"10\",\"goodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"goodsCode\":\"301020000049\",\"goodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"goodsFullName\":null,\"goodsBasicUnitName\":\"个\",\"goodsAssistUnitName\":\"个\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productLineId\":null,\"unitId\":\"UNIT-12\",\"unitCode\":\"EA\",\"unitName\":\"个\",\"transferNum\":25.00000000,\"onwayNum\":null,\"totalOutNum\":null,\"totalInNum\":null,\"unitPrice\":null,\"amountMoney\":0E-8,\"remark\":null,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"receiverAddress\":null,\"provinceId\":null,\"provinceCode\":null,\"provinceName\":null,\"cityId\":null,\"cityCode\":null,\"cityName\":null,\"countyId\":null,\"countyCode\":null,\"countyName\":null,\"townId\":null,\"townCode\":null,\"townName\":null,\"detailAddr\":null,\"receiver\":null,\"receiverPhone\":null,\"receiverPhoneSpare\":null,\"isClose\":0,\"sourceId\":null,\"sourceLineNum\":null,\"sourceType\":null,\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"itemId\":\"0Wfar8LVlCZOkFv2gos9\",\"billId\":\"0kxUvN0mm3QI7AhjYqSM\",\"parentGoodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"parentGoodsCode\":\"301020000049\",\"parentGoodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"parentGoodsdisplayName\":null,\"parentRowNum\":\"10\",\"childGoodsQty\":null,\"firstBillBomCode\":null,\"srcBillBomCode\":null,\"outStorageId\":\"1001ZZ100000000DPAP4\",\"outStorageCode\":\"test030201\",\"outStorageName\":\"测试仓库030201\",\"outIfSlotManage\":null,\"inStorageId\":\"1001ZZ100000000DPAP6\",\"inStorageCode\":\"test030202\",\"inStorageName\":\"test030202\",\"inIfSlotManage\":null,\"outPositionId\":null,\"outPositionCode\":null,\"outPositionName\":null}],\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"isDistribution\":null,\"isReturned\":null}]}}', 'User': 'Manager', 'DependCase': 'submit_allocation_bill', 'RelevanceList': '{\"billId\":\"$..id\"}', 'Sql': '', 'IsDepend': ''}"}], "start": 1589351919441, "stop": 1589351924291, "uuid": "bfef72b9-f8aa-463f-88a1-158853dbc090", "historyId": "ff0a6c3798e6cc541c8d59b55a5f821e", "testCaseId": "a7532dad0b171d55a5c81c01d5f070e2", "fullName": "case.test_allocation.TestCase#test_api", "labels": [{"name": "feature", "value": "渠道云接口自动化测试"}, {"name": "story", "value": "调拨模块测试"}, {"name": "parentSuite", "value": "case"}, {"name": "suite", "value": "test_allocation"}, {"name": "subSuite", "value": "TestCase"}, {"name": "host", "value": "xmlydeMacBook-Pro.local"}, {"name": "thread", "value": "49281-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "case.test_allocation"}]}