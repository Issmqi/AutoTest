{"name": "test_api[case_data14]", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'dict'", "trace": "self = <case.test_allocation.TestCase object at 0x109358198>\ncase_data = {'APIName': '查询调拨入库订单详情', 'CaseId': 15.0, 'CaseName': 'get_transfer-in-bills', 'CheckTpye': 'check_json', ...}\n\n    @pytest.mark.parametrize('case_data', case_dict, ids=[])\n    @allure.story(\"调拨模块测试\")\n    @pytest.mark.flaky(reruns=3, reruns_delay=3)\n    def test_api(self, case_data):\n        '''\n        :param case_data: 测试用例\n        :return:\n        '''\n        code, response = h.send_requests(case_data)\n>       result = checkResult.check_result(case_data, code, response)\n\ntest_allocation.py:51: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../util/checkResult.py:84: in check_result\n    allure.attach(res_data,'实际data')\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py:164: in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n../venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py:215: in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py:117: in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <allure_commons.logger.AllureFileLogger object at 0x1092d1588>\nbody = {'billCode': 'TDN2020050900003', 'billDate': 1588953600000, 'billStatusCode': '01', 'billStatusId': '099aj5df-4y42-4700-d8d6-3714fdb43e68', ...}\nfile_name = 'bbc9dd7a-b483-4e9f-97ed-9420965f37d7-attachment.attach'\n\n    @hookimpl\n    def report_attached_data(self, body, file_name):\n        destination = os.path.join(self._report_dir, file_name)\n        with open(destination, 'wb') as attached_file:\n            if isinstance(body, text_type):\n                attached_file.write(body.encode('utf-8'))\n            else:\n>               attached_file.write(body)\nE               TypeError: a bytes-like object is required, not 'dict'\n\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py:62: TypeError"}, "description": "\n        :param case_data: 测试用例\n        :return:\n        ", "steps": [{"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "014e2cbf-0464-4149-b3f9-c074fbe3da56-attachment.attach"}, {"name": "用例名称:", "source": "c9545f4c-b2a1-492c-8e78-cc46f883fb3d-attachment.attach"}, {"name": "请求地址:", "source": "25c29bc6-772c-44aa-8885-4d1fb6c49ba8-attachment.attach"}, {"name": "请求头", "source": "d4ff93b3-3da9-4bb9-b990-76c0b0ecb79c-attachment.attach"}, {"name": "请求参数类型", "source": "573a5a02-6c05-41d7-8456-4bbbfa826abd-attachment.attach"}, {"name": "请求参数", "source": "c3e2024e-4907-4c07-808f-3e27193eb608-attachment.attach"}], "start": 1589352320431, "stop": 1589352320437}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "463f0ae1-4d3c-44fa-b134-6da4ae66cdeb-attachment.attach"}, {"name": "用例名称:", "source": "fd239b39-e24b-4b59-83c3-2ed5a36b898d-attachment.attach"}, {"name": "请求地址:", "source": "640a4256-4aa1-461b-b181-9121d161c000-attachment.attach"}, {"name": "请求头", "source": "f5d7a9b4-256a-4113-9ed4-adaf2d50498a-attachment.attach"}, {"name": "请求参数类型", "source": "0c05a9be-2a5b-41e7-886c-8ff1111be834-attachment.attach"}, {"name": "请求参数", "source": "0262f0be-1c5b-40d4-baf8-f6e012b98b70-attachment.attach"}], "start": 1589352323950, "stop": 1589352323955}, {"name": "校验返回json数据结构", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'dict'\n", "trace": "  File \"/Users/xmly/python/AutoTest/util/checkResult.py\", line 84, in check_result\n    allure.attach(res_data,'实际data')\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py\", line 164, in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py\", line 215, in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py\", line 117, in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py\", line 62, in report_attached_data\n    attached_file.write(body)\n"}, "attachments": [{"name": "预期code", "source": "da47c304-0bff-4001-afd6-4e73a0297474-attachment.attach"}, {"name": "实际code是", "source": "bfab9888-d106-4020-975c-1b0a44cc0be4-attachment.attach"}, {"name": "预期data", "source": "8091c8e1-d755-46f0-b58a-9c68078db50d-attachment.attach"}, {"name": "实际data", "source": "bbc9dd7a-b483-4e9f-97ed-9420965f37d7-attachment.attach"}], "start": 1589352324076, "stop": 1589352324080}], "attachments": [{"name": "log", "source": "36e5f4b5-4ec9-4122-a573-5493dba24405-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case_data", "value": "{'CaseId': 15.0, 'CaseName': 'get_transfer-in-bills', 'APIName': '查询调拨入库订单详情', 'Headers': '', 'Path': '/occ-stock/stock/transfer-in-bills/findByParentid', 'Method': 'get', 'ParameterType': 'parameter', 'Params': '{\"id\":\"create-transfer-in1\",\"search_AUTH_APPCODE\":\"transferInBill\"}', 'CheckTpye': 'check_json', 'ExpectedCode': 200.0, 'ExpectedData': '{\"id\":\"0aCwS5YrnRm6S7RHlOXZ\",\"dr\":0,\"ts\":1589012705000,\"creator\":\"smq\",\"creationTime\":1589012705000,\"modifier\":null,\"modifiedTime\":null,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"stockOrgId\":\"abd7cf79-511d-4307-9bbd-d288b18d0ef9\",\"stockOrgCode\":\"1210\",\"stockOrgName\":\"西安喜马拉雅网络科技有限公司\",\"stockOrgInId\":\"abd7cf79-511d-4307-9bbd-d288b18d0ef9\",\"stockOrgInCode\":\"1210\",\"stockOrgInName\":\"西安喜马拉雅网络科技有限公司\",\"billCode\":\"TRN2020050900013\",\"billDate\":1588953600000,\"billType\":\"AllocationIn\",\"billTranTypeId\":\"AllocationIn\",\"billTranTypeCode\":\"AllocationIn\",\"billTranTypeName\":\"调拨入库\",\"storageId\":\"1001ZZ100000000DPAP6\",\"storageCode\":\"test030202\",\"storageName\":\"test030202\",\"ifSlotManage\":null,\"outStorageId\":\"1001ZZ100000000DPAP4\",\"outStorageCode\":\"test030201\",\"outStorageName\":\"测试仓库030201\",\"outIfSlotManage\":null,\"storekeeperId\":null,\"storekeeperCode\":null,\"storekeeperName\":null,\"inDate\":null,\"planArriveDate\":null,\"currencyId\":null,\"currencyCode\":null,\"currencyName\":null,\"totalShouldInNum\":5.00000000,\"totalFactInNum\":3.00000000,\"billStatusId\":\"099aj5df-4y42-4700-d8d6-3714fdb43e68\",\"billStatusCode\":\"01\",\"billStatusName\":\"自由\",\"stockBillBelong\":\"0DKeeV9TPwv3UZiad8EH\",\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"bizPersonId\":null,\"bizPersonCode\":null,\"bizPersonName\":null,\"deparmentId\":\"ae96b9ed-82dc-4aa7-bf97-cdd18a18c1a9\",\"deparmentCode\":\"01010102\",\"deparmentName\":\"城市经理\",\"logisticsId\":null,\"logisticsCode\":null,\"logisticsName\":null,\"realLogisticsCompanyId\":null,\"realLogisticsCompanyCode\":null,\"realLogisticsCompanyName\":null,\"logisticsBillCode\":null,\"siger\":null,\"signTime\":null,\"cancelReason\":null,\"remark\":\"自动化测试参照调拨出库单新增调拨入库单\",\"transferInBillItems\":[{\"id\":\"0Z8SQSmZtDN7o4b5u7I8\",\"dr\":0,\"ts\":1589012723000,\"creator\":\"smq\",\"creationTime\":1589012723000,\"modifier\":null,\"modifiedTime\":null,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"transferInBillId\":null,\"rowNum\":10,\"goodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"goodsCode\":\"301020000049\",\"goodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"goodsFullName\":null,\"goodsBasicUnitName\":\"个\",\"goodsAssistUnitName\":\"个\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productLineId\":null,\"isOptional\":null,\"unitId\":\"UNIT-12\",\"unitCode\":\"EA\",\"unitName\":\"个\",\"shouldInNum\":5.00000000,\"factInNum\":3.00000000,\"unitPrice\":null,\"amountMoney\":0E-8,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"stockInPersonId\":null,\"stockInPersonCode\":null,\"stockInPersonName\":null,\"stockInDate\":null,\"firstBillCode\":\"DBO20200508000034\",\"firstBillBcode\":\"0Tr6HVsgvmzwBQYy2d6i\",\"firstBillType\":null,\"srcBillCode\":\"TDN2020050900003\",\"srcBillBcode\":\"0RVbhbtQZhT5PZkp19zW\",\"srcBillType\":\"AllocationOut\",\"remark\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"isMotherPiece\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"enableBatchNoManage\":null,\"enableInvStatusManage\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"ext01\":\"3.00000000\",\"ext02\":null,\"ext03\":\"AllocationOut\",\"ext04\":\"Allocation\",\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":\"0TszFCIVqcbJkmpWHQhq\",\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null}],\"transferInBillItemBoms\":[{\"id\":\"0P13ZigHlYHvTIuUCTj1\",\"dr\":0,\"ts\":1589012723000,\"creator\":\"smq\",\"creationTime\":1589012723000,\"modifier\":null,\"modifiedTime\":null,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"rowNum\":\"10\",\"goodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"goodsCode\":\"301020000049\",\"goodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"goodsFullName\":null,\"goodsBasicUnitName\":\"个\",\"goodsAssistUnitName\":\"个\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productLineId\":null,\"unitId\":\"UNIT-12\",\"unitCode\":\"EA\",\"unitName\":\"个\",\"shouldInNum\":5.00000000,\"factInNum\":3.00000000,\"unitPrice\":null,\"amountMoney\":0E-8,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"stockInPersonId\":null,\"stockInPersonCode\":null,\"stockInPersonName\":null,\"stockInDate\":null,\"firstBillCode\":\"0DKeeV9TPwv3UZiad8EH\",\"firstBillBcode\":\"0Tr6HVsgvmzwBQYy2d6i\",\"firstBillType\":null,\"srcBillCode\":\"TDN2020050900003\",\"srcBillBcode\":\"0RVbhbtQZhT5PZkp19zW\",\"srcBillType\":null,\"remark\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"itemId\":\"0Z8SQSmZtDN7o4b5u7I8\",\"billId\":null,\"parentGoodsId\":\"03e77ae0-469d-4d8a-ba34-733c2ada3749\",\"parentGoodsCode\":\"301020000049\",\"parentGoodsName\":\"小雅AI音箱旗舰版_石墨绿\",\"parentGoodsdisplayName\":null,\"parentRowNum\":\"10\",\"childGoodsQty\":null,\"firstBillBomCode\":\"0CrhvlIZ5uIVEXmYN9Hq\",\"srcBillBomCode\":\"0K1xchlRSFmYGxaooi2J\",\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":\"0TszFCIVqcbJkmpWHQhq\",\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null}],\"srcSystem\":null,\"srcSystemId\":null,\"srcSystemCode\":null,\"srcSystemName\":null,\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"sycnOutStatus\":null,\"sycnNCStatus\":null}', 'User': 'Manager', 'DependCase': 'create_transfer-in-bills', 'RelevanceList': '{\"id\":\"$..id\"}', 'Sql': '', 'IsDepend': ''}"}], "start": 1589352320377, "stop": 1589352324080, "uuid": "7ec242c4-f250-4b2b-af0d-997d321c3d1c", "historyId": "c041c789ba9f1fd5d14930edc4e68454", "testCaseId": "a7532dad0b171d55a5c81c01d5f070e2", "fullName": "case.test_allocation.TestCase#test_api", "labels": [{"name": "feature", "value": "渠道云接口自动化测试"}, {"name": "story", "value": "调拨模块测试"}, {"name": "parentSuite", "value": "case"}, {"name": "suite", "value": "test_allocation"}, {"name": "subSuite", "value": "TestCase"}, {"name": "host", "value": "xmlydeMacBook-Pro.local"}, {"name": "thread", "value": "49478-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "case.test_allocation"}]}