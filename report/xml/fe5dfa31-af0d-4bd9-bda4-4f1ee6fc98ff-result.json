{"name": "test_api[case_data8]", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'int'", "trace": "self = <case.test_allocation.TestCase object at 0x10e418438>\ncase_data = {'APIName': '查询调拨出库订单详情', 'CaseId': 9.0, 'CaseName': 'get_transfer-out-bills', 'CheckTpye': 'check_json', ...}\n\n    @pytest.mark.parametrize('case_data', case_dict, ids=[])\n    @allure.story(\"调拨模块测试\")\n    @pytest.mark.flaky(reruns=3, reruns_delay=3)\n    def test_api(self, case_data):\n        '''\n        :param case_data: 测试用例\n        :return:\n        '''\n        code, response = h.send_requests(case_data)\n>       result = checkResult.check_result(case_data, code, response)\n\ntest_allocation.py:51: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../util/checkResult.py:81: in check_result\n    allure.attach(int(case['ExpectedCode']),'预期code')\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py:164: in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n../venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py:215: in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py:117: in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n../venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py:87: in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <allure_commons.logger.AllureFileLogger object at 0x10da5a588>\nbody = 200, file_name = 'ca58c759-2f21-446c-ae5a-bfa63ca68e92-attachment.attach'\n\n    @hookimpl\n    def report_attached_data(self, body, file_name):\n        destination = os.path.join(self._report_dir, file_name)\n        with open(destination, 'wb') as attached_file:\n            if isinstance(body, text_type):\n                attached_file.write(body.encode('utf-8'))\n            else:\n>               attached_file.write(body)\nE               TypeError: a bytes-like object is required, not 'int'\n\n../venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py:62: TypeError"}, "description": "\n        :param case_data: 测试用例\n        :return:\n        ", "steps": [{"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "69ebd490-942b-4090-9441-77df5c0f8857-attachment.attach"}, {"name": "用例名称:", "source": "6bb8ab9d-208a-44e7-b8b4-7b0472e70399-attachment.attach"}, {"name": "请求地址:", "source": "2856c64a-6f01-459e-ad31-69ed383b72e5-attachment.attach"}, {"name": "请求头", "source": "b5ee5313-f2ed-4182-b477-1db458025c60-attachment.attach"}, {"name": "请求参数类型", "source": "3a33d2fc-d6b0-4a10-b80e-ef1738e1584c-attachment.attach"}, {"name": "请求参数", "source": "af93190f-d60a-45de-9202-7dfb6915a0e0-attachment.attach"}], "start": 1589351514941, "stop": 1589351514945}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "67a74dd9-643e-42f8-b004-66510b4edc7a-attachment.attach"}, {"name": "用例名称:", "source": "961ae0df-5581-490d-9707-5f90361eaaa9-attachment.attach"}, {"name": "请求地址:", "source": "41f87f24-66bb-482d-902b-95678a02ec89-attachment.attach"}, {"name": "请求头", "source": "f970c3d2-8c4b-4199-9b31-aa2f27ad9506-attachment.attach"}, {"name": "请求参数类型", "source": "0cbaa3f2-7aea-4a10-b7a9-4e3222f81983-attachment.attach"}, {"name": "请求参数", "source": "df7b592a-ba8b-4155-a32e-ad216b37ba4a-attachment.attach"}], "start": 1589351518071, "stop": 1589351518074}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "5c6ead00-0017-419e-8968-a8a32451151d-attachment.attach"}, {"name": "用例名称:", "source": "a5d95392-9b96-49db-8286-866709428b53-attachment.attach"}, {"name": "请求地址:", "source": "217ac13f-efe1-4365-bc39-42e8547a2693-attachment.attach"}, {"name": "请求头", "source": "e1341ea9-8103-4b98-be7b-7ebea55ee47b-attachment.attach"}, {"name": "请求参数类型", "source": "c261b051-8295-4fad-ad21-fc146b113483-attachment.attach"}, {"name": "请求参数", "source": "d8ccdce9-1e2c-49ad-b40a-85e8e1f98a27-attachment.attach"}], "start": 1589351518577, "stop": 1589351518584}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "b989dae1-b904-49f8-8c6c-571d3f538afd-attachment.attach"}, {"name": "用例名称:", "source": "741dabc4-920b-42a3-9737-244ff0485103-attachment.attach"}, {"name": "请求地址:", "source": "d609565c-3cfb-430e-8892-d6759c2b9700-attachment.attach"}, {"name": "请求头", "source": "03fee2c5-aead-4da2-8a3d-6c2ec310cd1f-attachment.attach"}, {"name": "请求参数类型", "source": "cf7dfb8f-d0bf-4305-9d67-f9494d1d6d90-attachment.attach"}, {"name": "请求参数", "source": "41b2bd51-8ac5-460c-8060-ae6b1bbeacd8-attachment.attach"}], "start": 1589351519781, "stop": 1589351519786}, {"name": "开始请求接口", "status": "passed", "attachments": [{"name": "请求类型", "source": "31661043-ae40-46b5-a02c-4312e181dadc-attachment.attach"}, {"name": "用例名称:", "source": "77d75bf5-6444-4ee0-95bb-623c308e7b2e-attachment.attach"}, {"name": "请求地址:", "source": "4e421b23-6f2f-42e1-b2cc-4dda4e3f50cf-attachment.attach"}, {"name": "请求头", "source": "3dd61603-a1d7-4aa8-b22f-6dade8d28e4a-attachment.attach"}, {"name": "请求参数类型", "source": "c292fd6e-3d6f-4251-878c-f3e5897c85bb-attachment.attach"}, {"name": "请求参数", "source": "56c3f789-420f-4f9f-875d-45b03f43d56a-attachment.attach"}], "start": 1589351525119, "stop": 1589351525125}, {"name": "校验返回json数据结构", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'int'\n", "trace": "  File \"/Users/xmly/python/AutoTest/util/checkResult.py\", line 81, in check_result\n    allure.attach(int(case['ExpectedCode']),'预期code')\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/_allure.py\", line 164, in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_pytest/listener.py\", line 215, in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/reporter.py\", line 117, in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/hooks.py\", line 286, in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\n    firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\n    return outcome.get_result()\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\n    raise ex[1].with_traceback(ex[2])\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\n    res = hook_impl.function(*args)\n  File \"/Users/xmly/python/AutoTest/venv/bin/python/lib/python3.6/site-packages/allure_commons/logger.py\", line 62, in report_attached_data\n    attached_file.write(body)\n"}, "attachments": [{"name": "预期code", "source": "ca58c759-2f21-446c-ae5a-bfa63ca68e92-attachment.attach"}], "start": 1589351525637, "stop": 1589351525637}], "attachments": [{"name": "log", "source": "ac4d9037-2211-45b5-9246-d678511e60a9-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case_data", "value": "{'CaseId': 9.0, 'CaseName': 'get_transfer-out-bills', 'APIName': '查询调拨出库订单详情', 'Headers': '', 'Path': '/occ-stock/stock/transfer-out-bills/findByParentid', 'Method': 'get', 'ParameterType': 'parameter', 'Params': '{\"id\":\"create-transfer-out1\",\"search_AUTH_APPCODE\":\"transferOutBill\"}', 'CheckTpye': 'check_json', 'ExpectedCode': 200.0, 'ExpectedData': '{\"id\":\"09hvzd0ZYcNlm2Acrklt\",\"dr\":0,\"ts\":1587882709000,\"creator\":\"tmq\",\"creationTime\":1587882670000,\"modifier\":\"tmq\",\"modifiedTime\":1587882709000,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"stockOrgId\":\"e53fc87e-1a16-4a2b-978c-63bfd14fd88b\",\"stockOrgCode\":\"1101\",\"stockOrgName\":\"上海证大喜马拉雅网络科技有限公司\",\"stockOrgInId\":\"abd7cf79-511d-4307-9bbd-d288b18d0ef9\",\"stockOrgInCode\":\"1210\",\"stockOrgInName\":\"西安喜马拉雅网络科技有限公司\",\"billCode\":\"TDN2020042600004\",\"billDate\":1587830400000,\"billType\":\"AllocationOut\",\"billTranTypeId\":\"AllocationOut\",\"billTranTypeCode\":\"AllocationOut\",\"billTranTypeName\":\"调拨出库\",\"storageId\":\"28332dbd-b2d2-4b1f-bc71-3c3c665c658f\",\"storageCode\":\"110102\",\"storageName\":\"知识卡仓\",\"ifSlotManage\":null,\"inStorageId\":\"0iBm0HSL0DzMt3O1Ivs9\",\"inStorageCode\":\"121007\",\"inStorageName\":\"高新咖啡店\",\"inIfSlotManage\":null,\"storekeeperId\":null,\"storekeeperCode\":null,\"storekeeperName\":null,\"planSendDate\":null,\"planArriveDate\":null,\"currencyId\":null,\"currencyCode\":null,\"currencyName\":null,\"totalShouldOutNum\":1.00000000,\"totalFactOutNum\":1.00000000,\"billStatusId\":\"099aj5df-4y42-4k00-d8d0-3714fdb43e6k\",\"billStatusCode\":\"02\",\"billStatusName\":\"已签字\",\"stockBillBelong\":\"0NfjSVvc0jVxlBNvSScj\",\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"bizPersonId\":null,\"bizPersonCode\":null,\"bizPersonName\":null,\"deparmentId\":\"0WQbT14w7gylOnPhY2eT\",\"deparmentCode\":\"FCDEPT01\",\"deparmentName\":\"形态转换部门01\",\"logisticsId\":null,\"logisticsCode\":null,\"logisticsName\":null,\"realLogisticsCompanyId\":null,\"realLogisticsCompanyCode\":null,\"realLogisticsCompanyName\":null,\"logisticsBillCode\":null,\"siger\":\"tmq\",\"signTime\":1587882709000,\"cancelReason\":null,\"remark\":null,\"transferBillOutItems\":[{\"id\":\"0XGKeUIfxCyfIAyiaaJ3\",\"dr\":0,\"ts\":1587882693000,\"creator\":\"tmq\",\"creationTime\":1587882693000,\"modifier\":null,\"modifiedTime\":null,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"transferOutBillId\":\"09hvzd0ZYcNlm2Acrklt\",\"rowNum\":10,\"goodsId\":\"1b6fd0b2-c2c7-490a-9a6e-4404028bb50e\",\"goodsCode\":\"344030000001\",\"goodsName\":\"喜马拉雅财经创业知识通兑卡（9选1）\",\"goodsDisplayName\":\"喜马拉雅财经创业知识通兑卡（9选1）\",\"goodsBasicUnitName\":\"张\",\"goodsAssistUnitName\":\"张\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productCode\":null,\"productLineId\":null,\"isOptional\":null,\"unitId\":\"cc7d062c-53ad-4ab2-9fe6-63ef173f0a00\",\"unitCode\":\"003\",\"unitName\":\"张\",\"shouldOutNum\":1.00000000,\"factOutNum\":1.00000000,\"unitPrice\":20.00000000,\"amountMoney\":20.00000000,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"stockOutPersonId\":null,\"stockOutPersonCode\":null,\"stockOutPersonName\":null,\"stockOutDate\":null,\"receiverAddress\":null,\"provinceId\":null,\"provinceCode\":null,\"provinceName\":null,\"cityId\":null,\"cityCode\":null,\"cityName\":null,\"countyId\":null,\"countyCode\":null,\"countyName\":null,\"townId\":null,\"townCode\":null,\"townName\":null,\"detailAddr\":null,\"receiver\":null,\"receiverPhone\":null,\"receiverPhoneSpare\":null,\"firstBillCode\":\"DBO20200426000005\",\"firstBillBcode\":\"0pVyy865O7Ogtc0YnSjh\",\"firstBillType\":\"Allocation\",\"srcBillCode\":\"DBO20200426000005\",\"srcBillBcode\":\"0pVyy865O7Ogtc0YnSjh\",\"srcBillType\":\"Allocation\",\"remark\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"isMotherPiece\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"enableBatchNoManage\":null,\"enableInvStatusManage\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"ext01\":\"1.00000000\",\"ext02\":null,\"ext03\":\"COO7-Cxx-03\",\"ext04\":\"COO7-Cxx-03\",\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"outStorageId\":null,\"outStorageCode\":null,\"outStorageName\":null,\"outIfSlotManage\":null,\"inStorageId\":null,\"inStorageCode\":null,\"inStorageName\":null,\"inIfSlotManage\":null}],\"transferOutBillItemBoms\":[{\"id\":\"0P2eVkhQHqVyzLrCQZvI\",\"dr\":0,\"ts\":1587882693000,\"creator\":\"tmq\",\"creationTime\":1587882693000,\"modifier\":null,\"modifiedTime\":null,\"persistStatus\":\"nrm\",\"promptMessage\":null,\"rowNum\":\"10\",\"goodsId\":\"1b6fd0b2-c2c7-490a-9a6e-4404028bb50e\",\"goodsCode\":\"344030000001\",\"goodsName\":\"喜马拉雅财经创业知识通兑卡（9选1）\",\"goodsDisplayName\":\"喜马拉雅财经创业知识通兑卡（9选1）\",\"goodsBasicUnitName\":\"张\",\"goodsAssistUnitName\":\"张\",\"goodsConversionRate\":1.000000,\"enableBatchNumberManage\":null,\"productId\":null,\"productLineId\":null,\"unitId\":\"cc7d062c-53ad-4ab2-9fe6-63ef173f0a00\",\"unitCode\":\"003\",\"unitName\":\"张\",\"shouldOutNum\":1.00000000,\"factOutNum\":1.00000000,\"unitPrice\":20.00000000,\"amountMoney\":20.00000000,\"batchNumId\":null,\"batchNumCode\":null,\"batchNumName\":null,\"goodsPositionId\":null,\"goodsPositionCode\":null,\"goodsPositionName\":null,\"stockOutPersonId\":null,\"stockOutPersonCode\":null,\"stockOutPersonName\":null,\"stockOutDate\":null,\"receiverAddress\":null,\"provinceId\":null,\"provinceCode\":null,\"provinceName\":null,\"cityId\":null,\"cityCode\":null,\"cityName\":null,\"countyId\":null,\"countyCode\":null,\"countyName\":null,\"townId\":null,\"townCode\":null,\"townName\":null,\"detailAddr\":null,\"receiver\":null,\"receiverPhone\":null,\"receiverPhoneSpare\":null,\"firstBillCode\":\"0NfjSVvc0jVxlBNvSScj\",\"firstBillBcode\":\"0pVyy865O7Ogtc0YnSjh\",\"firstBillType\":\"Allocation\",\"srcBillCode\":\"DBO20200426000005\",\"srcBillBcode\":\"0pVyy865O7Ogtc0YnSjh\",\"srcBillType\":\"Allocation\",\"remark\":null,\"goodsVersion\":\"1\",\"goodsSelection\":null,\"customerId\":null,\"customerCode\":null,\"customerName\":null,\"supplierId\":null,\"supplierCode\":null,\"supplierName\":null,\"projectId\":null,\"projectCode\":null,\"projectName\":null,\"batchCodeId\":null,\"batchCodeCode\":null,\"stockStateId\":null,\"stockStateCode\":null,\"stockStateName\":null,\"originalGoodsId\":null,\"goodsSelectionDescription\":null,\"itemId\":\"0XGKeUIfxCyfIAyiaaJ3\",\"billId\":null,\"parentGoodsId\":\"1b6fd0b2-c2c7-490a-9a6e-4404028bb50e\",\"parentGoodsCode\":\"344030000001\",\"parentGoodsName\":\"喜马拉雅财经创业知识通兑卡（9选1）\",\"parentGoodsdisplayName\":null,\"parentRowNum\":\"10\",\"childGoodsQty\":null,\"firstBillBomCode\":\"0T4TSD2BkEYNkAawoFlN\",\"srcBillBomCode\":\"0T4TSD2BkEYNkAawoFlN\",\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null}],\"srcSystem\":null,\"srcSystemId\":null,\"srcSystemCode\":null,\"srcSystemName\":null,\"ext01\":null,\"ext02\":null,\"ext03\":null,\"ext04\":null,\"ext05\":null,\"ext06\":null,\"ext07\":null,\"ext08\":null,\"ext09\":null,\"ext10\":null,\"ext11\":null,\"ext12\":null,\"ext13\":null,\"ext14\":null,\"ext15\":null,\"sycnOutStatus\":null,\"sycnNCStatus\":null}', 'User': 'Manager', 'DependCase': 'create_transfer-out-bills', 'RelevanceList': '{\"id\":\"$..id\"}', 'Sql': '', 'IsDepend': ''}"}], "start": 1589351514791, "stop": 1589351525638, "uuid": "21543365-120e-47c3-9019-93327998f5f3", "historyId": "eefd906d21114be63c81ef46335e3f92", "testCaseId": "a7532dad0b171d55a5c81c01d5f070e2", "fullName": "case.test_allocation.TestCase#test_api", "labels": [{"name": "story", "value": "调拨模块测试"}, {"name": "feature", "value": "渠道云接口自动化测试"}, {"name": "parentSuite", "value": "case"}, {"name": "suite", "value": "test_allocation"}, {"name": "subSuite", "value": "TestCase"}, {"name": "host", "value": "xmlydeMacBook-Pro.local"}, {"name": "thread", "value": "49122-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "case.test_allocation"}]}