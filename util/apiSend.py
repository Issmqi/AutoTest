import allure
import login
import logging
import apiMethod

from readConfig import ReadConfig

readConfig=ReadConfig()

def send_request(request_data):
    '''

    :param request_data: 单条用例数据
    :return:
    '''

    host = ReadConfig().get_config("HTTP", "host")

    manager_session = login.manager_login()
    customer_01_session = login.customer_01_login()
    customer_02_session = login.customer_02_login()

    casename = request_data['CaseName']
    user = request_data['User']
    header = request_data['Headers']
    method = request_data['Method']
    path = request_data['Path']
    parameter = request_data['Params']


    url = host + path
    login.manager_login()

    if method == 'post':
        with allure.step("POST请求接口"):
            allure.attach("请求接口：", str(casename))
            allure.attach("请求地址", url)
            allure.attach("请求头", str(header))
            allure.attach("请求参数", str(parameter))
        result = apiMethod.post(url=url,header=header,data=parameter)

    elif method == 'get':
        with allure.step("GET请求接口"):
            allure.attach("请求接口：", str(casename))
            allure.attach("请求地址", url)
            allure.attach("请求头", str(header))
            allure.attach("请求参数", str(parameter))
        result = apiMethod.post(url=url,header=header,data=parameter)

    else:
        result = {"code": False, "data": False}
    logging.info("请求接口结果：\n %s" % str(result))
    print("请求接口结果：\n %s" % str(result))
    return result

# data={'CaseId': 2, 'Designer': '师孟奇', 'CaseName': '新增外部采购订单', 'APIName': '采购管理', 'Headers': '{"Content-Type": "application/json", "charset": "UTF-8"}', 'Path': '/occ-purchase/purchase/orders', 'Method': 'post', 'Params': '{"code":None,"state":0,"displayName":None,"version":None,"id":None,"purchaseOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","purchaseOrgName":None,"orderCode":None,"otherOrderNum":None,"orderDate":1583942400000,"purchaseType":"OuterPurchase","tranTypeId":"GeneralPurchase","tranTypeName":None,"tranTypeCode":"GeneralPurchase","supplierId":"1001A910000000007A4O","selfLifing":"02","supplierName":None,"supplierCode":"10000352","purchasePersonId":None,"purchasePersonCode":None,"purchasePersonName":None,"purchaseDeptId":"0K1ovYvAl1Pk00oCRPjV","purchaseDeptName":None,"purchaseDeptCode":None,"totalGoodsNum":10,"totalAmountMoney":"10.00","currencyId":None,"currencyName":None,"status":"01","operationCode":None,"approveStatus":"01","isClosed":"0","approvalSummary":None,"erpStatus":None,"refusedReason":None,"confirmPerson":None,"remark":None,"isReturned":"0","returnedOrder":None,"creator":None,"creationTime":"","modifier":None,"modifiedTime":"","ext15":None,"ext14":None,"ext13":None,"ext12":None,"ext11":"0","planArrivalDate":"","demandStockOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","arrivalBelongCode":"01","receiveStorageOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","receiveStorageId":"0bxYF73VWxwqf6bb3ib4","customerId":None,"receiveContact":None,"receiveContactPhone":None,"demandStockOrgName":None,"arrivalBelongName":None,"receiveStorageOrgName":None,"receiveStorageName":None,"customerName":None,"persistStatus":"new","orderItems":[{"rowNum":10,"goodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","goodsName":"小雅AI音箱旗舰版_石墨绿","goodsCode":"301020000049","unitId":"UNIT-12","unitCode":"EA","unitName":"个","goodsNum":"10.000000","unitPrice":"1.00000000","amountMoney":"10.00","isGift":"0","goodsSelection":None,"goodsVersion":"1","projectId":None,"projectCode":None,"projectName":None,"sourceType":None,"sourceId":None,"sourceLineNum":None,"isClosed":"0","stockStatus":"01","payStatus":None,"arrivalBelongId":None,"arrivalBelongName":None,"arrivalBelongCode":"01","demandStockOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","demandStockOrgName":None,"demandStockOrgCode":None,"receiveStorageOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","receiveStorageOrgName":None,"receiveStorageOrgCode":None,"receiveStorageId":"0bxYF73VWxwqf6bb3ib4","receiveStorageName":None,"receiveStorageCode":None,"customerId":None,"customerCode":None,"customerName":None,"countryId":None,"countryName":None,"countryCode":None,"provinceId":None,"provinceName":None,"provinceCode":None,"cityId":None,"cityName":None,"cityCode":None,"districtId":None,"districtName":None,"districtCode":None,"townId":None,"townName":None,"townCode":None,"receiveContact":None,"receiveContactPhone":None,"receiveAddress":None,"detailAddr":None,"addStorageAmount":None,"returnGoodsAmount":None,"baseGoodsOptId":None,"isOptional":None,"name":None,"productid":None,"productidCode":None,"productidName":None,"productidStandardName":None,"productidSaleSeriesId":None,"productidSaleSeriesName":None,"num":None,"dr":None,"creator":None,"creationTime":"","modifier":None,"modifiedTime":"","originalGoodsId":None,"goodsSelectionDescription":None,"batchCode":None,"ext06":"0","ext07":None,"ext08":None,"outerStock":None,"srcBillCode":None,"srcBillBcode":None,"srcBillType":None,"ext01":"10.00000000","ext02":"UNIT-12","ext03":"EA","ext04":"个","ext05":"1.00","ext09":"1.00000000","ext13":None,"ext12":None,"ext10":None,"persistStatus":"new"}],"orderItemBoms":[{"rowNum":10,"goodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","goodsName":"小雅AI音箱旗舰版_石墨绿","goodsCode":"301020000049","unitId":"UNIT-12","unitCode":"EA","unitName":"个","goodsNum":"10.000000","unitPrice":"1.00000000","amount":None,"amountMoney":"10.00","isGift":"0","sourceType":None,"sourceId":None,"sourceLineNum":None,"isClosed":"0","stockStatus":None,"payStatus":None,"arrivalBelongId":None,"arrivalBelongName":None,"arrivalBelongCode":"01","demandStockOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","demandStockOrgName":None,"demandStockOrgCode":None,"receiveStorageOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","receiveStorageOrgName":None,"receiveStorageOrgCode":None,"receiveStorageId":"0bxYF73VWxwqf6bb3ib4","receiveStorageName":None,"receiveStorageCode":None,"customerId":None,"customerCode":None,"customerName":None,"countryId":None,"countryName":None,"countryCode":None,"provinceId":None,"provinceName":None,"provinceCode":None,"cityId":None,"cityName":None,"cityCode":None,"districtId":None,"districtName":None,"districtCode":None,"townId":None,"townName":None,"townCode":None,"receiveContact":None,"receiveContactPhone":None,"receiveAddress":None,"detailAddr":None,"addStorageAmount":None,"returnGoodsAmount":None,"name":None,"productid":None,"productidCode":None,"productidName":None,"productidStandardName":None,"productidSaleSeriesId":None,"productidSaleSeriesName":None,"dr":None,"creator":None,"creationTime":"","modifier":None,"modifiedTime":"","goodsVersion":"1","goodsSelection":None,"projectId":None,"projectCode":None,"projectName":None,"parentGoodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","parentGoodsCode":None,"parentGoodsName":"小雅AI音箱旗舰版_石墨绿","parentRowNum":10,"childGoodsQty":None,"originalGoodsId":None,"goodsSelectionDescription":None,"baseGoodsOptId":None,"batchCode":None,"isOptional":None,"num":None,"ext06":"0","ext07":None,"ext08":None,"outerStock":None,"srcBillCode":None,"srcBillBcode":None,"srcBillType":None,"ext01":None,"ext02":"UNIT-12","ext03":"EA","ext04":"个","ext05":"1.00","ext09":None,"ext13":None,"ext12":None,"ext10":None,"persistStatus":"new"}]}', 'CheckTpye': 'check_json', 'ExpectedCode': 200.0, 'ExpectedData': '{"id":"0EMnXiZmH1ORYDJEkdyt","dr":0,"ts":1584006061000,"creator":"gaojian","creationTime":1584006061000,"modifier":null,"modifiedTime":null,"persistStatus":"nrm","promptMessage":null,"state":0,"approver":null,"approveTime":null,"approveOpinion":null,"sycnNCStatus":null,"sycnOutStatus":null,"purchaseOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","purchaseOrgCode":"1210","purchaseOrgName":"西安喜马拉雅网络科技有限公司","orderType":"PurchaseBill","orderCode":"OPO20200312000010","otherOrderNum":null,"orderDate":1583942400000,"planArrivalDate":null,"purchaseType":"OuterPurchase","supplierId":"1001A910000000007A4O","supplierCode":"10000352","supplierName":"上海艾臣营销策划有限公司","purchasePersonId":null,"purchasePersonCode":null,"purchasePersonName":null,"purchaseDeptId":"0K1ovYvAl1Pk00oCRPjV","purchaseDeptCode":"01010102","purchaseDeptName":"城市经理","totalGoodsNum":10.00000000,"totalAmountMoney":10.00000000,"currencyId":null,"currencyCode":null,"currencyName":null,"status":"01","erpStatus":null,"refusedReason":null,"confirmPerson":null,"remark":null,"isReturned":0,"returnedOrder":null,"payStatus":null,"isClosed":0,"tranTypeId":"GeneralPurchase","tranTypeCode":"GeneralPurchase","tranTypeName":"普通采购","orderItems":[{"id":"0YJOfKtKCaPTNcSxdPgt","dr":0,"ts":1584006061000,"creator":"gaojian","creationTime":1584006061000,"modifier":null,"modifiedTime":null,"persistStatus":"nrm","promptMessage":null,"orderId":null,"purchaseOrg":null,"orderType":null,"orderCode":null,"otherOrderNum":null,"orderDate":null,"purchaseType":null,"supplier":"1001A910000000007A4O","purchasePerson":null,"purchaseDept":"0K1ovYvAl1Pk00oCRPjV","totalAmount":null,"totalMoney":null,"status":null,"remark":null,"orderPayStatus":null,"rowNum":"10","goodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","goodsCode":"301020000049","goodsDisplayName":"小雅AI音箱旗舰版_石墨绿","goodsName":"小雅AI音箱旗舰版_石墨绿","isOptional":null,"unitId":"UNIT-12","unitCode":"EA","unitName":"个","goodsNum":10.00000000,"unitPrice":1.00000000,"amountMoney":10.00000000,"srcBillType":null,"srcBillId":null,"srcBillCode":null,"srcBillBcode":null,"arrivalBelongId":"512ef9a1-cbb6-4f45-801f-251fb883078c","arrivalBelongCode":"01","arrivalBelongName":"自有","receiveStorageOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","receiveStorageOrgCode":"1210","receiveStorageOrgName":"西安喜马拉雅网络科技有限公司","receiveStorageId":"0bxYF73VWxwqf6bb3ib4","receiveStorageCode":"2123445","receiveStorageName":"曲江书城店仓","customerId":null,"customerCode":null,"customerName":null,"receiveAddress":null,"addStorageAmount":null,"returnGoodsAmount":null,"isClosed":0,"payStatus":null,"isGift":0,"countryId":null,"countryCode":null,"countryName":null,"provinceId":null,"provinceCode":null,"provinceName":null,"cityId":null,"cityCode":null,"cityName":null,"districtId":null,"districtCode":null,"districtName":null,"townId":null,"townCode":null,"townName":null,"receiveContact":null,"receiveContactPhone":null,"purchaseOrderId":"0EMnXiZmH1ORYDJEkdyt","demandStockOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","demandStockOrgCode":"1210","demandStockOrgName":"西安喜马拉雅网络科技有限公司","couldOutNum":null,"stockStatus":"01","detailAddr":null,"batchCode":null,"projectId":null,"projectCode":null,"projectName":null,"applyReturnNum":null,"ext13":null,"ext01":"10.00000000","ext04":"个","ext05":"1.00","ext02":"UNIT-12","ext03":"EA","ext06":"0","ext07":null,"ext08":null,"ext09":"1.00000000","ext10":null,"ext11":null,"ext12":null,"ext14":null,"ext15":null,"goodsVersion":"1","goodsSpec":null,"goodsModelNum":null,"openCloseReason":null,"goodsSelection":null,"isMotherPiece":null,"arrangeConts":null,"originalGoodsId":null,"goodsSelectionDescription":null}],"ext01":null,"ext02":null,"ext03":null,"ext04":null,"ext05":null,"ext06":null,"ext07":null,"ext08":null,"ext09":null,"ext10":null,"ext11":"0","ext12":null,"ext13":null,"ext14":null,"ext15":null,"settlementModeId":null,"settlementModeCode":null,"settlementModeName":null,"selfLifing":"02","orderItemBoms":[{"id":"0OEJuv3GJxMVTlavcv3x","dr":0,"ts":1584006061000,"creator":"gaojian","creationTime":1584006061000,"modifier":null,"modifiedTime":null,"persistStatus":"nrm","promptMessage":null,"rowNum":"10","goodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","goodsCode":"301020000049","goodsName":"小雅AI音箱旗舰版_石墨绿","goodsDisplayName":"小雅AI音箱旗舰版_石墨绿","goodsBasicUnitName":"个","goodsAssistUnitName":"个","goodsConversionRate":1.000000,"enableBatchNumberManage":null,"productId":null,"productLineId":null,"goodsVersion":"1","goodsSelection":null,"goodsNum":10.00000000,"unitPrice":1.00000000,"amountMoney":10.00000000,"itemId":"0YJOfKtKCaPTNcSxdPgt","billId":null,"srcBillId":null,"srcBillCode":null,"srcBillBcode":null,"srcBillType":null,"firstBillCode":null,"firstBillBcode":null,"firstBillType":null,"isGift":0,"countryId":null,"countryCode":null,"countryName":null,"provinceId":null,"provinceCode":null,"provinceName":null,"cityId":null,"cityCode":null,"cityName":null,"districtId":null,"districtCode":null,"districtName":null,"townId":null,"townCode":null,"townName":null,"receiveContact":null,"receiveContactPhone":null,"demandStockOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","demandStockOrgCode":"1210","demandStockOrgName":"西安喜马拉雅网络科技有限公司","stockStatus":null,"detailAddr":null,"goodsSpec":null,"goodsModelNum":null,"openCloseReason":null,"parentGoodsId":"03e77ae0-469d-4d8a-ba34-733c2ada3749","parentGoodsCode":"301020000049","parentGoodsName":"小雅AI音箱旗舰版_石墨绿","displayName":null,"parentRowNum":"10","arrivalBelongId":"512ef9a1-cbb6-4f45-801f-251fb883078c","arrivalBelongCode":"01","arrivalBelongName":"自有","receiveStorageOrgId":"abd7cf79-511d-4307-9bbd-d288b18d0ef9","receiveStorageOrgCode":"1210","receiveStorageOrgName":"西安喜马拉雅网络科技有限公司","receiveStorageId":"0bxYF73VWxwqf6bb3ib4","receiveStorageCode":"2123445","receiveStorageName":"曲江书城店仓","customerId":null,"customerCode":null,"customerName":null,"addStorageAmount":null,"returnGoodsAmount":null,"unitId":"UNIT-12","unitCode":"EA","unitName":"个","batchCode":null,"goodsSelectionDescription":null,"projectId":null,"projectCode":null,"projectName":null,"isClosed":0,"applyReturnNum":null,"childGoodsQty":null,"ext01":null,"ext02":"UNIT-12","ext03":"EA","ext04":"个","ext05":"1.00","ext06":"0","ext07":null,"ext08":null,"ext09":null,"ext10":null,"ext11":null,"ext12":null,"ext13":null,"ext14":null,"ext15":null,"originalGoodsId":null,"firstBillBomCode":null,"srcBillBomCode":null}],"coordinationOrderCode":null,"isEc":null,"otherOrders":[]}', 'User': 'Manager', 'Correlation': '', 'Active': '', 'Sql': ''}
#
# send_request(data)